(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5856:function(){},7761:function(){},2678:function(){},5819:function(){},4112:function(){},7747:function(t,e,i){Promise.resolve().then(i.bind(i,5721))},5721:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return o}});var n=i(7437),s=i(2265),r=i(4033),a=i(7923);function o(){let t=(0,r.useRouter)(),{note:e,onNoteChange:i}=u(),s=async()=>{if(e)try{let{id:i,key:n}=await a.$.createNote(e);t.push("/view/".concat(i).concat("?key=".concat(n)))}catch(t){console.error("Failed to create a note:",t)}};return(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"note-info",children:"Your record will be stored for couple of days. Markdown is supported."}),(0,n.jsxs)("div",{className:"create-header",children:[(0,n.jsx)("div",{}),(0,n.jsx)("button",{onClick:s,className:"save-note",children:"Save note"})]}),(0,n.jsx)("textarea",{className:"note-value",value:e,onChange:i})]})}let u=()=>{let[t,e]=s.useState("");return{note:t,onNoteChange:t=>{var i;e(null==t?void 0:null===(i=t.currentTarget)||void 0===i?void 0:i.value)}}}},1177:function(t,e,i){"use strict";var n,s;i.d(e,{c:function(){return n},m:function(){return r}});let r="/flush-notes/1/note/proto";(s=n||(n={})).Initializing="Initializing...",s.WaitingForPeers="Waiting for peers...",s.Connected="Connected",s.Failed="Failed to initialize(see logs)"},7923:function(t,e,i){"use strict";i.d(e,{$:function(){return l}});var n=i(7441),s=i(1177),r=i(5136),a=i(8089),o=i(9710);class u{async createNote(t){var e;let i=(0,r.oQ)(),u=(0,r.Mf)({contentTopic:s.m,symKey:i,pubsubTopic:n.H5.pubsubTopic}),l=self.crypto.randomUUID();if(36!==l.length)throw"Unexpected uuid length";let c=await n.H5.send(u,{payload:(0,a.iY)(l+t)});return(null==c?void 0:null===(e=c.failures)||void 0===e?void 0:e.length)&&c.failures.length>0&&console.error("Failures when pushing note: ",c.failures.map(t=>t.error)),{id:l,key:(0,o.ci)(i)}}async readNote(t,e){await this.initMessages((0,o.nr)(e));let i=this.messages.map(t=>{try{let e=(0,a.Md)(t.payload),i=e.substring(0,36),n=e.substring(36);return{id:i,content:n}}catch(t){console.log("Failed to read message:",t)}}).find(e=>{if((null==e?void 0:e.id)===t)return!0});return null==i?void 0:i.content}async initMessages(t){if(this.subscription)return;let e=(0,r.UF)(s.m,t,n.H5.pubsubTopic);this.messages=await n.H5.getHistory(e),this.subscription=await n.H5.subscribe(e,t=>{this.messages.push(t)})}constructor(){this.messages=[]}}let l=new u},7441:function(t,e,i){"use strict";i.d(e,{H5:function(){return u},J9:function(){return n}});var n,s=i(1177),r=i(8089),a=i(9527);(n||(n={})).Status="status";class o{async init(){if(!this.initialized&&!this.initializing){this.initializing=!0;try{this.emitStatusEvent(s.c.Initializing),this.pubsubTopic=(0,a.L3)(s.m);let t=await (0,r.pq)({defaultBootstrap:!0,contentTopics:[s.m]});await t.start(),this.emitStatusEvent(s.c.WaitingForPeers),await (0,r.gT)(t,[r.Uw.Filter,r.Uw.LightPush,r.Uw.Store]),this.node=t,this.initialized=!0,this.emitStatusEvent(s.c.Connected)}catch(t){console.error("Failed to initialize Waku node:",t),this.emitStatusEvent(s.c.Failed)}this.initializing=!1}}addEventListener(t,e){return this.emitter.addEventListener(t,e)}removeEventListener(t,e){return this.emitter.removeEventListener(t,e)}send(t,e){var i;return this.ensureWakuInitialized(),null===(i=this.node)||void 0===i?void 0:i.lightPush.send(t,e)}async getHistory(t){this.ensureWakuInitialized();let e=[];for await(let i of this.node.store.queryGenerator([t])){let t=await Promise.all(i),n=t.filter(t=>!!t);e=[...e,...n]}return e}async subscribe(t,e){return this.ensureWakuInitialized(),this.node.filter.subscribe(t,e)}emitStatusEvent(t){this.emitter.dispatchEvent(new CustomEvent("status",{detail:t}))}ensureWakuInitialized(){if(!this.initialized){let t="Waku is not initialized.";throw console.log(t),Error(t)}}constructor(){this.emitter=new EventTarget,this.initialized=!1,this.initializing=!1}}let u=new o}},function(t){t.O(0,[948,990,971,472,744],function(){return t(t.s=7747)}),_N_E=t.O()}]);